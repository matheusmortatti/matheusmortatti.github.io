---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import BlogCard from '../components/blog/BlogCard.astro';

const allPosts = await getCollection('blog');
const recentPosts = allPosts
  .filter(post => !post.data.archived)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 3);
---

<BaseLayout
  title="Matheus Mortatti"
  description="Personal website and blog of Matheus Mortatti"
>
  <Header slot="header" />

  <div class="container">
    <div class="hero">
      <div class="profile-section">
        <img
          src="/images/profile.png"
          alt="Matheus Mortatti profile picture"
          class="profile-image"
        />
      </div>
      <div class="bio-section">
        <h1>Matheus Mortatti</h1>
        <p class="subtitle">Software Engineer @ Microsoft</p>
        <p class="bio">
          I'm a software engineer working at Microsoft. My interests lie in programming,
          3D design and printing, or anything creative that peaks my interest. I love to
          create things; the tools I need to use to get there are just a means to an end.
        </p>
        <div class="social-links">
          <a href="https://github.com/matheusmortatti" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
            </svg>
            GitHub
          </a>
          <a href="mailto:matheusmortatti@gmail.com" aria-label="Email">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
              <polyline points="22,6 12,13 2,6"></polyline>
            </svg>
            Email
          </a>
        </div>
      </div>
    </div>

    {recentPosts.length > 0 && (
      <section class="recent-posts">
        <div class="section-header">
          <h2>Recent Posts</h2>
          <a href="/blog" class="view-all">View all posts â†’</a>
        </div>
        <div class="posts-grid">
          {recentPosts.map(post => (
            <BlogCard
              title={post.data.title}
              slug={post.slug}
              date={post.data.date}
              description={post.data.description}
              tags={post.data.tags}
              archived={post.data.archived}
            />
          ))}
        </div>
      </section>
    )}
  </div>

  <Footer slot="footer" />
</BaseLayout>

<style>
  .hero {
    padding-top: var(--spacing-8);
    padding-bottom: var(--spacing-8);
    display: flex;
    gap: var(--spacing-8);
    align-items: center;
  }

  .profile-section {
    flex-shrink: 0;
  }

  .profile-image {
    width: 200px;
    height: 200px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid var(--color-surface-1);
  }

  .bio-section {
    flex: 1;
  }

  .bio-section h1 {
    margin-bottom: var(--spacing-1);
    font-size: var(--font-size-3xl);
  }

  .subtitle {
    font-size: var(--font-size-lg);
    color: var(--color-primary);
    font-weight: var(--font-weight-medium);
    margin-bottom: var(--spacing-4);
  }

  .bio {
    font-size: var(--font-size-base);
    color: var(--color-subtext-1);
    line-height: var(--line-height-relaxed);
    margin-bottom: var(--spacing-4);
  }

  .social-links {
    display: flex;
    gap: var(--spacing-4);
  }

  .social-links a {
    display: flex;
    align-items: center;
    gap: var(--spacing-2);
    color: var(--color-text);
    text-decoration: none;
    font-weight: var(--font-weight-medium);
    transition: color var(--transition-base);
    padding: var(--spacing-2) var(--spacing-3);
    border-radius: var(--radius-md);
    background: var(--color-surface-0);
    border: 1px solid var(--color-surface-1);
  }

  .social-links a:hover {
    color: var(--color-primary);
    border-color: var(--color-primary);
  }

  .social-links svg {
    width: 20px;
    height: 20px;
  }

  .recent-posts {
    margin-top: var(--spacing-12);
  }

  .section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-6);
  }

  .section-header h2 {
    font-size: var(--font-size-2xl);
    font-weight: var(--font-weight-bold);
  }

  .view-all {
    color: var(--color-primary);
    text-decoration: none;
    font-weight: var(--font-weight-medium);
    transition: color var(--transition-base);
  }

  .view-all:hover {
    color: var(--color-text);
  }

  .posts-grid {
    display: grid;
    gap: var(--spacing-6);
    grid-template-columns: 1fr;
  }

  @media (min-width: 640px) {
    .profile-image {
      width: 200px;
      height: 200px;
    }
  }

  @media (max-width: 640px) {
    .hero {
      flex-direction: column;
      text-align: center;
      gap: var(--spacing-6);
    }

    .profile-image {
      width: 150px;
      height: 150px;
    }

    .bio-section h1 {
      font-size: var(--font-size-2xl);
    }

    .social-links {
      justify-content: center;
    }

    .section-header {
      flex-direction: column;
      align-items: flex-start;
      gap: var(--spacing-2);
    }
  }

  @media (min-width: 768px) {
    .posts-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }
</style>
